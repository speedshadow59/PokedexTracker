trigger:
- main

pool:
  vmImage: ubuntu-latest

variables:
  app_location: 'PokedexTracker'

steps:
# Step 1: Copy frontend files to staging directory
- task: CopyFiles@2
  displayName: 'Copy frontend files'
  inputs:
    SourceFolder: '$(app_location)'
    Contents: '**'
    TargetFolder: '$(Build.ArtifactStagingDirectory)'

# Step 2: Publish artifact for Azure Static Web App
- task: PublishBuildArtifacts@1
  displayName: 'Publish frontend artifact'
  inputs:
    PathtoPublish: '$(Build.ArtifactStagingDirectory)'
    ArtifactName: 'frontend'
    publishLocation: 'Container'

# Step 3: Deploy to Azure Static Web App
- task: AzureStaticWebApp@0
  displayName: 'Deploy to Azure Static Web App'
  inputs:
    app_location: '$(app_location)'
    output_location: ''
    azure_static_web_apps_api_token: '$(AZURE_STATIC_WEB_APPS_API_TOKEN)'